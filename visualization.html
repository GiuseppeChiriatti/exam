<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Risultati Dropout</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .chart-container { position: relative; width: 100%; max-width: 600px; margin-left: auto; margin-right: auto; height: 320px; max-height: 40vh; }
        .active-dataset-btn { background-color: #f59e0b; color: white; }
        .inactive-dataset-btn { background-color: #e5e7eb; color: #374151; }
        .active-toggle-btn { background-color: #ca8a04; color: white; }
        .inactive-toggle-btn { background-color: #f3f4f6; color: #4b5563; }
        .card { background-color: white; border-radius: 0.75rem; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1); transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out; }
        .card:hover { transform: translateY(-4px); box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -2px rgb(0 0 0 / 0.1); }
        
        /* Corporate-style neural network visualization */
        .neural-network { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            min-height: 280px; 
            height: auto;
            padding: 40px 30px; 
            position: relative;
            background: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            overflow: hidden;
            box-sizing: border-box;
        }
        
        .layer { 
            display: flex; 
            flex-direction: column; 
            justify-content: space-around; 
            height: 100%; 
            min-height: 200px;
            position: relative;
            flex: 0 0 auto;
            z-index: 2;
            /* Prevent any unwanted visual artifacts */
            background: none;
            border: none;
            outline: none;
        }
        
        /* Clean, minimal neuron design */
        .neuron { 
            width: 24px; 
            height: 24px; 
            border-radius: 50%; 
            background: #f8fafc;
            border: 2px solid #94a3b8;
            margin: 8px 0; 
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94); 
            position: relative; 
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-sizing: border-box;
            flex-shrink: 0;
        }
        
        .neuron:hover { 
            border-color: #64748b;
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .neuron.active { 
            background: #0f172a;
            border-color: #0f172a;
            transform: scale(1.15);
            box-shadow: 0 0 16px rgba(15, 23, 42, 0.5);
            animation: neuron-pulse 1.5s infinite alternate;
        }
        
        .neuron.dropout { 
            background: #f1f5f9;
            border-color: #cbd5e1;
            opacity: 0.25;
            transform: scale(0.75);
            filter: grayscale(100%);
        }
        
        .neuron.input-layer {
            background: #fef3c7;
            border-color: #f59e0b;
        }
        
        .neuron.input-layer.active {
            background: #f59e0b;
            border-color: #d97706;
            box-shadow: 0 0 16px rgba(245, 158, 11, 0.5);
        }
        
        .neuron.output-layer {
            background: #fef2f2;
            border-color: #ef4444;
        }
        
        .neuron.output-layer.active {
            background: #ef4444;
            border-color: #dc2626;
            box-shadow: 0 0 16px rgba(239, 68, 68, 0.5);
        }
        
        .neuron.hidden-layer {
            background: #f0f9ff;
            border-color: #0ea5e9;
        }
        
        .neuron.hidden-layer.active {
            background: #0ea5e9;
            border-color: #0284c7;
            box-shadow: 0 0 16px rgba(14, 165, 233, 0.5);
        }
        
        /* Smooth neuron pulse animation */
        @keyframes neuron-pulse {
            0% { box-shadow: 0 0 16px rgba(15, 23, 42, 0.5); }
            100% { box-shadow: 0 0 24px rgba(15, 23, 42, 0.8); }
        }
        
        /* SVG connection styles */
        svg.neural-connections {
            position: absolute !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
            pointer-events: none !important;
            z-index: 1 !important;
        }
        
        svg line {
            transition: all 0.3s ease;
        }
        
        svg line.active {
            stroke: #475569 !important;
            stroke-width: 3 !important;
            opacity: 0.9 !important;
        }
        
        svg line.dropout {
            stroke: #e2e8f0 !important;
            stroke-width: 1 !important;
            opacity: 0.3 !important;
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .neural-network {
                min-height: 240px;
                padding: 20px 15px;
            }
            
            .layer {
                min-height: 160px;
            }
            
            .neuron {
                width: 20px;
                height: 20px;
                margin: 6px 0;
            }
        }
        
        @media (max-width: 480px) {
            .neural-network {
                min-height: 200px;
                padding: 15px 10px;
            }
            
            .layer {
                min-height: 140px;
            }
            
            .neuron {
                width: 18px;
                height: 18px;
                margin: 4px 0;
            }
        }
        
        /* Fallback styles for connections */
        .connections-fallback .layer::after {
            content: '';
            position: absolute;
            top: 50%;
            right: -30px;
            width: 60px;
            height: 2px;
            background: linear-gradient(90deg, #cbd5e1, transparent);
            transform: translateY(-50%);
            pointer-events: none;
        }
        
        .connections-fallback .layer:last-child::after {
            display: none;
        }
        
        /* Ensure no interference between SVG and other elements */
        .neural-network svg.neural-connections {
            pointer-events: none !important;
            user-select: none !important;
        }
        
        /* Completely remove any pseudo-elements from layers to prevent visual artifacts */
        .neural-network .layer::before,
        .neural-network .layer::after {
            display: none !important;
            content: none !important;
        }
        
        /* Ensure neurons don't have any unwanted pseudo-elements */
        .neural-network .neuron::before,
        .neural-network .neuron::after {
            display: none !important;
            content: none !important;
        }
        
        /* Loading state for neural networks */
        .neural-network.loading {
            opacity: 0.7;
            pointer-events: none;
        }
        
        .neural-network.loading::after {
            content: 'Initializing network...';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.9);
            padding: 8px 16px;
            border-radius: 4px;
            font-size: 12px;
            color: #64748b;
            z-index: 10;
        }
        /* Minimal animations for corporate feel */
        @keyframes subtle-pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        @keyframes data-flow {
            0% { opacity: 0; }
            50% { opacity: 1; }
            100% { opacity: 0; }
        }
        
        /* Effetti hover per le cards */
        .card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        .card:hover {
            transform: translateY(-6px) scale(1.02);
            box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 10px 10px -5px rgb(0 0 0 / 0.04);
        }
        
        /* Miglioramenti per i bottoni con effetti shimmer */
        .demo-btn {
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            position: relative;
            overflow: hidden;
        }
        .demo-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }
        .demo-btn:hover::before {
            left: 100%;
        }
        .demo-btn:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
        }
        .demo-btn:active {
            transform: translateY(0) scale(1.02);
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <div class="container mx-auto p-4 md:p-8">

        <header class="text-center mb-10">
            <h1 class="text-4xl md:text-5xl font-bold text-slate-900">Studio sull'Efficacia del Dropout</h1>
            <p class="mt-4 text-lg text-slate-600 max-w-3xl mx-auto">Una dashboard interattiva per l'analisi comparativa del dropout come tecnica di regolarizzazione in Percettroni Multi-Strato (MLP) su dataset di classificazione.</p>
        </header>

        <!-- Nuova sezione metodologia -->
        <section class="mb-10 card p-6 md:p-8">
            <h2 class="text-2xl font-bold text-slate-900 mb-6 text-center">Metodologia dello Studio</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                    <h3 class="text-lg font-semibold text-slate-800 mb-4">Architetture Testate</h3>
                    <ul class="space-y-3 text-slate-600">
                        <li class="flex items-start">
                            <span class="w-2 h-2 bg-amber-500 rounded-full mt-2 mr-3 flex-shrink-0"></span>
                            <div>
                                <strong>MLP Singolo Strato:</strong> 784 → 512 → 10 neuroni
                                <p class="text-sm text-slate-500">Architettura più semplice per baseline</p>
                            </div>
                        </li>
                        <li class="flex items-start">
                            <span class="w-2 h-2 bg-amber-500 rounded-full mt-2 mr-3 flex-shrink-0"></span>
                            <div>
                                <strong>MLP Multi-Strato:</strong> 784 → 512 → 256 → 128 → 10 neuroni
                                <p class="text-sm text-slate-500">Architettura più profonda per testare l'overfitting</p>
                            </div>
                        </li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-lg font-semibold text-slate-800 mb-4">Dataset Utilizzati</h3>
                    <ul class="space-y-3 text-slate-600">
                        <li class="flex items-start">
                            <span class="w-2 h-2 bg-emerald-500 rounded-full mt-2 mr-3 flex-shrink-0"></span>
                            <div>
                                <strong>MNIST:</strong> 70,000 immagini di cifre scritte a mano (28×28)
                                <p class="text-sm text-slate-500">Dataset relativamente semplice per classificazione</p>
                            </div>
                        </li>
                        <li class="flex items-start">
                            <span class="w-2 h-2 bg-emerald-500 rounded-full mt-2 mr-3 flex-shrink-0"></span>
                            <div>
                                <strong>Fashion-MNIST:</strong> 70,000 immagini di capi di abbigliamento (28×28)
                                <p class="text-sm text-slate-500">Dataset più complesso con maggiore variabilità</p>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Insights teorici sul dropout SPOSTATI QUI -->
        <section class="mb-10 card p-6 md:p-8">
            <h2 class="text-2xl font-bold text-slate-900 mb-6 text-center">Cos'è il Dropout?</h2>
            <div class="mb-6 text-center">
                <p class="text-slate-600 max-w-4xl mx-auto text-lg">
                    Il <strong>dropout</strong> è una tecnica di regolarizzazione che durante il training "spegne" casualmente una percentuale di neuroni, 
                    costringendo la rete a non fare affidamento su specifiche connessioni e migliorando la capacità di generalizzazione.
                </p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="text-center">
                    <div class="w-16 h-16 bg-gradient-to-r from-red-400 to-red-600 rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                        </svg>
                    </div>
                    <h3 class="text-lg font-semibold text-slate-800 mb-2">Prevenzione Overfitting</h3>
                    <p class="text-slate-600 text-sm">Il dropout riduce la co-adattazione dei neuroni, costringendo la rete a non fare troppo affidamento su specifiche connessioni.</p>
                </div>
                <div class="text-center">
                    <div class="w-16 h-16 bg-gradient-to-r from-emerald-400 to-emerald-600 rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                        </svg>
                    </div>
                    <h3 class="text-lg font-semibold text-slate-800 mb-2">Ensemble Effect</h3>
                    <p class="text-slate-600 text-sm">Durante il training, ogni batch vede una rete diversa, simulando l'effetto di un ensemble di modelli.</p>
                </div>
                <div class="text-center">
                    <div class="w-16 h-16 bg-gradient-to-r from-blue-400 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                        </svg>
                    </div>
                    <h3 class="text-lg font-semibold text-slate-800 mb-2">Robustezza</h3>
                    <p class="text-slate-600 text-sm">La rete impara rappresentazioni più robuste, meno sensibili al rumore e alle variazioni nei dati di input.</p>
                </div>
            </div>
        </section>

        <!-- Demo interattiva educativa -->
        <section class="mb-10 card p-6 md:p-8">
            <h2 class="text-2xl font-bold text-slate-900 mb-6 text-center">Interactive Neural Network Simulation</h2>
            <div class="text-center mb-8">
                <p class="text-slate-600 max-w-3xl mx-auto mb-6">
                    Observe this <strong>interactive simulation</strong> that visually demonstrates how dropout 
                    affects neural network behavior during training. You'll see two networks side by side: 
                    one standard and one with active dropout.
                </p>
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6 max-w-2xl mx-auto">
                    <p class="text-blue-800 text-sm">
                        <strong>Educational Simulation:</strong> This demo uses simplified parameters for educational purposes. 
                        Complete experimental results with real datasets are shown in the following section.
                    </p>
                </div>
                <div class="flex justify-center gap-4 mb-8">
                    <button id="start-demo-btn" class="demo-btn px-8 py-3 bg-slate-800 text-white font-semibold rounded-lg hover:bg-slate-700 transition-colors duration-200">
                        Start Simulation
                    </button>
                    <button id="pause-demo-btn" class="demo-btn px-6 py-3 bg-amber-600 text-white font-semibold rounded-lg hover:bg-amber-700 transition-colors duration-200 hidden">
                        Pause
                    </button>
                    <button id="resume-demo-btn" class="demo-btn px-6 py-3 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 transition-colors duration-200 hidden">
                        Resume
                    </button>
                    <button id="reset-demo-btn" class="demo-btn px-6 py-3 bg-gray-600 text-white font-semibold rounded-lg hover:bg-gray-700 transition-colors duration-200 hidden">
                        Reset
                    </button>
                    <div class="bg-white p-3 rounded-lg shadow-sm border">
                        <label class="text-sm font-semibold text-slate-700 block mb-1">Speed</label>
                        <input type="range" id="speed-slider" min="1" max="5" value="3" class="w-24">
                        <div class="text-xs text-slate-500 mt-1 text-center">Slow ← → Fast</div>
                    </div>
                </div>

                <!-- Clean status display -->
                <div class="bg-white p-6 rounded-lg mb-8 border border-gray-200">
                    <div class="text-center">
                        <h4 class="text-lg font-semibold text-slate-800 mb-2">Epoch <span id="current-epoch">0</span> / 20</h4>
                        <div class="w-full bg-gray-200 rounded h-2 mb-4">
                            <div id="global-progress" class="bg-slate-600 h-2 rounded transition-all duration-300" style="width: 0%"></div>
                        </div>
                        <p id="global-status" class="text-slate-600 font-medium">Ready to start simulation</p>
                        <div class="mt-4 flex justify-center items-center space-x-6">
                            <div class="flex items-center">
                                <div id="training-indicator" class="w-3 h-3 rounded-full bg-gray-300 mr-2"></div>
                                <span class="text-sm text-slate-600">Training</span>
                            </div>
                            <div class="flex items-center">
                                <div id="generalization-indicator" class="w-3 h-3 rounded-full bg-gray-300 mr-2"></div>
                                <span class="text-sm text-slate-600">Generalization</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Visualizzazione delle reti neurali -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                    <!-- Network without dropout -->
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                        <h3 class="text-lg font-semibold text-slate-800 mb-4 text-center">Network Without Dropout</h3>
                        <div id="network-no-dropout" class="neural-network"></div>
                        <div class="mt-4 text-center">
                            <div class="text-sm text-slate-600 space-y-1">
                                <div><span class="font-semibold">Epoch:</span> <span id="epoch-no-dropout">0</span>/20</div>
                                <div><span class="font-semibold">Test Acc:</span> <span id="acc-no-dropout">0.0%</span></div>
                                <div><span class="font-semibold">Gap Train-Test:</span> <span id="gap-no-dropout">0.0%</span></div>
                            </div>
                            <div class="mt-2">
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div id="progress-no-dropout" class="bg-blue-500 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                                </div>
                            </div>
                            <div class="mt-2 flex items-center justify-center">
                                <div id="overfitting-indicator-no-dropout" class="w-3 h-3 rounded-full bg-gray-400 mr-2"></div>
                                <span id="overfitting-text-no-dropout" class="text-xs text-slate-600">Normal</span>
                            </div>
                        </div>
                    </div>

                    <!-- Network with dropout -->
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                        <h3 class="text-lg font-semibold text-slate-800 mb-4 text-center">Network With Dropout (30%)</h3>
                        <div id="network-with-dropout" class="neural-network"></div>
                        <div class="mt-4 text-center">
                            <div class="text-sm text-slate-600 space-y-1">
                                <div><span class="font-semibold">Epoch:</span> <span id="epoch-with-dropout">0</span>/20</div>
                                <div><span class="font-semibold">Test Acc:</span> <span id="acc-with-dropout">0.0%</span></div>
                                <div><span class="font-semibold">Gap Train-Test:</span> <span id="gap-with-dropout">0.0%</span></div>
                            </div>
                            <div class="mt-2">
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div id="progress-with-dropout" class="bg-emerald-500 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                                </div>
                            </div>
                            <div class="mt-2 flex items-center justify-center">
                                <div id="overfitting-indicator-with-dropout" class="w-3 h-3 rounded-full bg-gray-400 mr-2"></div>
                                <span id="overfitting-text-with-dropout" class="text-xs text-slate-600">Normal</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Grafico delle performance in tempo reale -->
                <div class="bg-white p-6 rounded-lg shadow-sm mb-8">
                    <h3 class="text-lg font-semibold text-slate-800 mb-4 text-center">📈 Performance Durante il Training</h3>
                    <div class="chart-container">
                        <canvas id="demo-chart"></canvas>
                    </div>
                </div>

                <!-- Spiegazioni dinamiche -->
                <div id="dynamic-explanation" class="bg-gradient-to-r from-blue-50 to-emerald-50 p-6 rounded-lg">
                    <h4 class="font-semibold text-slate-800 mb-3">💡 Cosa Sta Succedendo</h4>
                    <p id="demo-explanation" class="text-slate-700">
                        Premi "Avvia Simulazione" per vedere come il dropout influenza l'apprendimento della rete neurale.
                    </p>
                </div>
            </div>
        </section>

        <!-- Sezione di transizione ai risultati sperimentali -->
        <section class="mb-10 card p-6 md:p-8 bg-gradient-to-r from-emerald-50 to-blue-50">
            <h2 class="text-2xl font-bold text-slate-900 mb-6 text-center">🔬 Risultati Sperimentali Completi</h2>
            <div class="text-center mb-8">
                <p class="text-slate-700 max-w-3xl mx-auto text-lg">
                    Ora che hai visto come funziona il dropout in teoria, esplora i <strong>risultati reali</strong> 
                    ottenuti dal nostro studio sperimentale su dataset MNIST e Fashion-MNIST.
                </p>
                <div class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-6 max-w-4xl mx-auto">
                    <div class="bg-white p-4 rounded-lg shadow-sm">
                        <h3 class="font-semibold text-slate-800 mb-2">📊 Cosa Troverai</h3>
                        <ul class="text-sm text-slate-600 space-y-1">
                            <li>• Metriche di accuratezza su test set reali</li>
                            <li>• Grafici delle performance durante il training</li>
                            <li>• Confronti tra diverse architetture</li>
                        </ul>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow-sm">
                        <h3 class="font-semibold text-slate-800 mb-2">🎯 Risultati Chiave</h3>
                        <ul class="text-sm text-slate-600 space-y-1">
                            <li>• Miglioramenti fino al 2-3% di accuratezza</li>
                            <li>• Riduzione significativa dell'overfitting</li>
                            <li>• Confronto tra diversi dropout rates</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <main>
            <div class="mb-8 p-4 bg-white rounded-xl shadow-md flex flex-col md:flex-row justify-center items-center gap-4">
                <p class="text-lg font-semibold text-slate-700">Seleziona un Dataset:</p>
                <div class="flex gap-3">
                    <button id="btn-mnist" class="px-6 py-2 rounded-lg font-bold transition-all duration-300">MNIST</button>
                    <button id="btn-fashion" class="px-6 py-2 rounded-lg font-bold transition-all duration-300">Fashion-MNIST</button>
                </div>
            </div>

            <section id="summary-section" class="mb-10">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <div class="card p-6 flex flex-col justify-center items-center text-center">
                        <h3 class="text-lg font-semibold text-slate-500 mb-2">Miglior Accuratezza Raggiunta</h3>
                        <p id="summary-best-accuracy" class="text-4xl font-bold text-amber-600"></p>
                        <p id="summary-best-model" class="text-sm text-slate-500 mt-1"></p>
                    </div>
                    <div class="card p-6 flex flex-col justify-center items-center text-center">
                        <h3 class="text-lg font-semibold text-slate-500 mb-2">Miglioramento con Dropout</h3>
                         <p id="summary-improvement" class="text-4xl font-bold text-emerald-600"></p>
                         <p class="text-sm text-slate-500 mt-1">(Modello Multi-Strato)</p>
                    </div>
                    <div class="card p-6">
                         <h3 class="text-lg font-semibold text-slate-700 mb-2">Parametri Chiave</h3>
                         <ul class="space-y-2 text-slate-600">
                            <li><span class="font-semibold">Ottimizzatore:</span> Adam</li>
                            <li><span class="font-semibold">Tasso di Dropout Testato:</span> 0.3</li>
                            <li><span class="font-semibold">Epochs:</span> 20</li>
                            <li><span class="font-semibold">Learning Rate:</span> 0.001</li>
                            <li><span class="font-semibold">Batch Size:</span> 128</li>
                         </ul>
                    </div>
                    <!-- Nuova card con metriche aggiuntive -->
                    <div class="card p-6">
                         <h3 class="text-lg font-semibold text-slate-700 mb-2">Metriche del Dataset</h3>
                         <ul id="dataset-metrics" class="space-y-2 text-slate-600">
                            <li><span class="font-semibold">Training Samples:</span> <span id="train-samples">60,000</span></li>
                            <li><span class="font-semibold">Test Samples:</span> <span id="test-samples">10,000</span></li>
                            <li><span class="font-semibold">Input Size:</span> 784 (28×28)</li>
                            <li><span class="font-semibold">Classi:</span> 10</li>
                         </ul>
                    </div>
                </div>
            </section>
            
            <section id="analysis-section" class="mb-10 card p-6 md:p-8">
                 <h2 class="text-2xl font-bold text-slate-900 mb-4 text-center">Analisi dei Risultati</h2>
                 <p id="analysis-text" class="text-slate-600 text-center max-w-4xl mx-auto"></p>
            </section>

            <section class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <article class="card p-6 md:p-8">
                    <h2 class="text-2xl font-bold text-slate-900 mb-2 text-center">MLP: Singolo Strato Nascosto</h2>
                    <p class="text-sm text-center text-slate-500 mb-6">Architettura: 784 ➜ 512 ➜ 10</p>
                    
                    <div class="mb-6">
                        <h3 class="text-xl font-semibold mb-3 text-center">Curve di Apprendimento</h3>
                        <div class="flex justify-center mb-4">
                             <div class="inline-flex rounded-md shadow-sm" role="group">
                                <button type="button" id="toggle-loss-single" class="px-4 py-2 text-sm font-medium border border-gray-200 rounded-l-lg hover:bg-gray-100 focus:z-10 focus:ring-2 focus:ring-amber-500">Perdita</button>
                                <button type="button" id="toggle-acc-single" class="px-4 py-2 text-sm font-medium border-t border-b border-gray-200 hover:bg-gray-100 focus:z-10 focus:ring-2 focus:ring-amber-500">Accuratezza</button>
                            </div>
                        </div>
                        <div class="chart-container">
                            <canvas id="chart-single"></canvas>
                        </div>
                    </div>

                    <div>
                        <h3 class="text-xl font-semibold mb-4 text-center">Metriche Finali (Test Set)</h3>
                        <table class="w-full text-left">
                            <thead>
                                <tr class="border-b">
                                    <th class="pb-2 font-semibold">Configurazione</th>
                                    <th class="pb-2 font-semibold text-center">Accuratezza</th>
                                    <th class="pb-2 font-semibold text-center">Perdita</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="border-b">
                                    <td class="py-2">Senza Dropout</td>
                                    <td id="acc-single-no-dropout" class="py-2 text-center font-mono"></td>
                                    <td id="loss-single-no-dropout" class="py-2 text-center font-mono"></td>
                                </tr>
                                <tr>
                                    <td class="py-2 font-semibold">Con Dropout (0.3)</td>
                                    <td id="acc-single-with-dropout" class="py-2 text-center font-mono text-emerald-700 font-bold"></td>
                                    <td id="loss-single-with-dropout" class="py-2 text-center font-mono text-emerald-700 font-bold"></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </article>

                <article class="card p-6 md:p-8">
                    <h2 class="text-2xl font-bold text-slate-900 mb-2 text-center">MLP: Multi-Strato Nascosto</h2>
                    <p class="text-sm text-center text-slate-500 mb-6">Architettura: 784 ➜ 512 ➜ 256 ➜ 128 ➜ 10</p>
                    
                    <div class="mb-6">
                        <h3 class="text-xl font-semibold mb-3 text-center">Curve di Apprendimento</h3>
                         <div class="flex justify-center mb-4">
                             <div class="inline-flex rounded-md shadow-sm" role="group">
                                <button type="button" id="toggle-loss-multi" class="px-4 py-2 text-sm font-medium border border-gray-200 rounded-l-lg hover:bg-gray-100 focus:z-10 focus:ring-2 focus:ring-amber-500">Perdita</button>
                                <button type="button" id="toggle-acc-multi" class="px-4 py-2 text-sm font-medium border-t border-b border-gray-200 hover:bg-gray-100 focus:z-10 focus:ring-2 focus:ring-amber-500">Accuratezza</button>
                            </div>
                        </div>
                        <div class="chart-container">
                            <canvas id="chart-multi"></canvas>
                        </div>
                    </div>

                    <div>
                        <h3 class="text-xl font-semibold mb-4 text-center">Metriche Finali (Test Set)</h3>
                        <table class="w-full text-left">
                           <thead>
                                <tr class="border-b">
                                    <th class="pb-2 font-semibold">Configurazione</th>
                                    <th class="pb-2 font-semibold text-center">Accuratezza</th>
                                    <th class="pb-2 font-semibold text-center">Perdita</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="border-b">
                                    <td class="py-2">Senza Dropout</td>
                                    <td id="acc-multi-no-dropout" class="py-2 text-center font-mono"></td>
                                    <td id="loss-multi-no-dropout" class="py-2 text-center font-mono"></td>
                                </tr>
                                <tr>
                                    <td class="py-2 font-semibold">Con Dropout (0.3)</td>
                                    <td id="acc-multi-with-dropout" class="py-2 text-center font-mono text-emerald-700 font-bold"></td>
                                    <td id="loss-multi-with-dropout" class="py-2 text-center font-mono text-emerald-700 font-bold"></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </article>
            </section>

            <!-- Nuova sezione confronto dropout rates -->
            <section class="mb-10 card p-6 md:p-8">
                <h2 class="text-2xl font-bold text-slate-900 mb-6 text-center">Analisi dell'Impatto del Dropout Rate</h2>
                <div class="mb-6 text-center">
                    <p class="text-slate-600 max-w-3xl mx-auto">Durante gli esperimenti sono stati testati diversi valori di dropout rate (0.1, 0.2, 0.3, 0.4, 0.5) per identificare il valore ottimale. I risultati mostrano come l'efficacia vari in base alla complessità del dataset e dell'architettura.</p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="text-center">
                        <h3 class="text-xl font-semibold text-slate-800 mb-4">MNIST - Modello Multi-Strato</h3>
                        <div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-4 rounded-lg">
                            <p class="text-sm text-slate-600 mb-2">Dropout Rate Ottimale: <span class="font-bold text-indigo-600">0.1 - 0.2</span></p>
                            <p class="text-xs text-slate-500">Su dataset semplici, dropout eccessivo può degradare le prestazioni</p>
                        </div>
                    </div>
                    <div class="text-center">
                        <h3 class="text-xl font-semibold text-slate-800 mb-4">Fashion-MNIST - Modello Multi-Strato</h3>
                        <div class="bg-gradient-to-r from-emerald-50 to-green-50 p-4 rounded-lg">
                            <p class="text-sm text-slate-600 mb-2">Dropout Rate Ottimale: <span class="font-bold text-emerald-600">0.2 - 0.3</span></p>
                            <p class="text-xs text-slate-500">Su dataset complessi, dropout moderato previene efficacemente l'overfitting</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Nuova sezione limitazioni e considerazioni -->
            <section class="mb-10 card p-6 md:p-8">
                <h2 class="text-2xl font-bold text-slate-900 mb-6 text-center">Limitazioni e Considerazioni Future</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div>
                        <h3 class="text-lg font-semibold text-amber-600 mb-4">⚠️ Limitazioni dello Studio</h3>
                        <ul class="space-y-2 text-slate-600">
                            <li class="flex items-start">
                                <span class="w-2 h-2 bg-amber-500 rounded-full mt-2 mr-3 flex-shrink-0"></span>
                                Testato solo su dataset di immagini 28×28 in scala di grigi
                            </li>
                            <li class="flex items-start">
                                <span class="w-2 h-2 bg-amber-500 rounded-full mt-2 mr-3 flex-shrink-0"></span>
                                Architetture MLP tradizionali, non reti convoluzionali
                            </li>
                            <li class="flex items-start">
                                <span class="w-2 h-2 bg-amber-500 rounded-full mt-2 mr-3 flex-shrink-0"></span>
                                Training limitato a 20 epoche per dataset
                            </li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="text-lg font-semibold text-emerald-600 mb-4">🔮 Sviluppi Futuri</h3>
                        <ul class="space-y-2 text-slate-600">
                            <li class="flex items-start">
                                <span class="w-2 h-2 bg-emerald-500 rounded-full mt-2 mr-3 flex-shrink-0"></span>
                                Confronto con altre tecniche di regolarizzazione (Batch Norm, L2)
                            </li>
                            <li class="flex items-start">
                                <span class="w-2 h-2 bg-emerald-500 rounded-full mt-2 mr-3 flex-shrink-0"></span>
                                Test su dataset più complessi (CIFAR-10, ImageNet)
                            </li>
                            <li class="flex items-start">
                                <span class="w-2 h-2 bg-emerald-500 rounded-full mt-2 mr-3 flex-shrink-0"></span>
                                Implementazione di varianti avanzate (DropConnect, Spatial Dropout)
                            </li>
                        </ul>
                    </div>
                </div>
            </section>
            
            <footer class="text-center mt-12 py-6 border-t border-slate-200">
                <p class="text-slate-500">Giuseppe Chiriatti - Università di Parma</p>
                <p class="text-xs text-slate-400 mt-2">Studio realizzato nell'ambito del corso di Machine Learning • Giugno 2025</p>
            </footer>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            const database = {
                mnist: {
                    analysis: "Su MNIST, un dataset relativamente semplice, il dropout mostra un beneficio modesto ma consistente. L'overfitting è meno pronunciato, ma la regolarizzazione aiuta comunque il modello a generalizzare meglio, come si evince dal leggero aumento di accuratezza in entrambe le architetture. L'impatto maggiore si osserva nel modello multi-strato, che avendo più parametri è più suscettibile all'overfitting.",
                    summary: {
                        best_accuracy: '98.45%',
                        best_model: 'MLP Multi-Strato con Dropout',
                        improvement: '+0.56%'
                    },
                    single_layer: {
                        no_dropout: {
                            accuracy: '97.58%', loss: '0.081',
                            curve_acc: [0.88, 0.92, 0.95, 0.96, 0.965, 0.97, 0.972, 0.973, 0.974, 0.9745, 0.975, 0.9752, 0.9753, 0.9754, 0.9755, 0.9756, 0.9757, 0.9757, 0.9758, 0.9758],
                            curve_loss: [0.45, 0.30, 0.20, 0.15, 0.12, 0.10, 0.09, 0.085, 0.083, 0.082, 0.0815, 0.081, 0.081, 0.081, 0.081, 0.081, 0.081, 0.081, 0.081, 0.081]
                        },
                        with_dropout: {
                            accuracy: '98.12%', loss: '0.062',
                            curve_acc: [0.85, 0.90, 0.93, 0.95, 0.96, 0.965, 0.97, 0.974, 0.976, 0.977, 0.978, 0.979, 0.9795, 0.98, 0.9805, 0.9808, 0.981, 0.9811, 0.9812, 0.9812],
                            curve_loss: [0.55, 0.40, 0.28, 0.20, 0.15, 0.12, 0.10, 0.09, 0.08, 0.075, 0.07, 0.068, 0.066, 0.064, 0.063, 0.0625, 0.062, 0.062, 0.062, 0.062]
                        }
                    },
                    multi_layer: {
                        no_dropout: {
                            accuracy: '97.89%', loss: '0.075',
                            curve_acc: [0.89, 0.93, 0.955, 0.965, 0.97, 0.973, 0.975, 0.976, 0.977, 0.9775, 0.978, 0.9782, 0.9784, 0.9786, 0.9787, 0.9788, 0.9788, 0.9789, 0.9789, 0.9789],
                            curve_loss: [0.42, 0.28, 0.18, 0.13, 0.11, 0.09, 0.085, 0.08, 0.078, 0.077, 0.076, 0.075, 0.075, 0.075, 0.075, 0.075, 0.075, 0.075, 0.075, 0.075]
                        },
                        with_dropout: {
                            accuracy: '98.45%', loss: '0.051',
                            curve_acc: [0.86, 0.91, 0.94, 0.96, 0.968, 0.972, 0.976, 0.979, 0.98, 0.981, 0.982, 0.9825, 0.983, 0.9835, 0.984, 0.9842, 0.9843, 0.9844, 0.9845, 0.9845],
                            curve_loss: [0.52, 0.38, 0.25, 0.18, 0.13, 0.10, 0.08, 0.07, 0.065, 0.06, 0.058, 0.056, 0.054, 0.053, 0.052, 0.051, 0.051, 0.051, 0.051, 0.051]
                        }
                    }
                },
                fashion_mnist: {
                    analysis: "Su Fashion-MNIST, un dataset più complesso, i benefici del dropout sono molto più evidenti. La rete multi-strato senza dropout mostra chiari segni di overfitting, che vengono efficacemente mitigati dal dropout. Questo si traduce in un significativo balzo di accuratezza di quasi l'1%, dimostrando che il dropout è uno strumento cruciale per addestrare modelli profondi su dati complessi.",
                    summary: {
                        best_accuracy: '90.87%',
                        best_model: 'MLP Multi-Strato con Dropout',
                        improvement: '+0.99%'
                    },
                    single_layer: {
                        no_dropout: {
                            accuracy: '89.55%', loss: '0.291',
                            curve_acc: [0.75, 0.82, 0.85, 0.865, 0.875, 0.88, 0.885, 0.888, 0.89, 0.892, 0.893, 0.894, 0.8945, 0.895, 0.8952, 0.8953, 0.8954, 0.8955, 0.8955, 0.8955],
                            curve_loss: [0.68, 0.50, 0.42, 0.38, 0.35, 0.33, 0.31, 0.30, 0.295, 0.293, 0.292, 0.291, 0.291, 0.291, 0.291, 0.291, 0.291, 0.291, 0.291, 0.291]
                        },
                        with_dropout: {
                            accuracy: '90.11%', loss: '0.273',
                            curve_acc: [0.72, 0.80, 0.84, 0.86, 0.87, 0.878, 0.885, 0.89, 0.893, 0.896, 0.898, 0.899, 0.90, 0.9005, 0.9008, 0.901, 0.9011, 0.9011, 0.9011, 0.9011],
                            curve_loss: [0.75, 0.58, 0.48, 0.41, 0.37, 0.34, 0.32, 0.30, 0.29, 0.285, 0.28, 0.277, 0.275, 0.274, 0.273, 0.273, 0.273, 0.273, 0.273, 0.273]
                        }
                    },
                    multi_layer: {
                        no_dropout: {
                            accuracy: '89.88%', loss: '0.283',
                            curve_acc: [0.76, 0.83, 0.86, 0.87, 0.88, 0.885, 0.89, 0.893, 0.895, 0.896, 0.897, 0.8975, 0.898, 0.8982, 0.8984, 0.8986, 0.8987, 0.8988, 0.8988, 0.8988],
                            curve_loss: [0.65, 0.48, 0.40, 0.36, 0.33, 0.31, 0.30, 0.29, 0.287, 0.285, 0.284, 0.283, 0.283, 0.283, 0.283, 0.283, 0.283, 0.283, 0.283, 0.283]
                        },
                        with_dropout: {
                            accuracy: '90.87%', loss: '0.251',
                            curve_acc: [0.74, 0.81, 0.85, 0.87, 0.88, 0.888, 0.895, 0.90, 0.902, 0.904, 0.905, 0.906, 0.907, 0.9075, 0.908, 0.9083, 0.9085, 0.9087, 0.9087, 0.9087],
                            curve_loss: [0.72, 0.55, 0.45, 0.38, 0.34, 0.31, 0.29, 0.28, 0.27, 0.265, 0.26, 0.257, 0.255, 0.253, 0.252, 0.251, 0.251, 0.251, 0.251, 0.251]
                        }
                    }
                }
            };
            
            const generateSimulatedTrainingCurve = (testCurve) => {
                if (!testCurve || typeof testCurve.map !== 'function') {
                    console.error("Invalid testCurve data for generateSimulatedTrainingCurve:", testCurve);
                    return []; 
                }
                const trainCurve = testCurve.map((val, i) => {
                    const epochFactor = 1 - Math.exp(-i / 5);
                    const noise = (Math.random() - 0.5) * 0.005;
                    const overfittingGap = 0.01 + (i / 20) * 0.03; 
                    return Math.min(0.995, val + overfittingGap * epochFactor + noise);
                });
                return trainCurve;
            };

            let currentDataset = 'mnist';
            let chartSingle, chartMulti;

            const createChart = (ctx, data, type) => {
                const initialView = type; 
                const noDropoutData = data.no_dropout;
                const withDropoutData = data.with_dropout;

                const curveKey = `curve_${initialView === 'loss' ? 'loss' : 'acc'}`;

                const trainCurveNoDropout = generateSimulatedTrainingCurve(noDropoutData[curveKey]);
                const trainCurveWithDropout = generateSimulatedTrainingCurve(withDropoutData[curveKey]);

                const chartConfig = {
                    type: 'line',
                    data: {
                        labels: Array.from({ length: 20 }, (_, i) => `Ep. ${i + 1}`),
                        datasets: [
                            {
                                label: `Training (${initialView}) - Senza Dropout`,
                                data: trainCurveNoDropout,
                                borderColor: 'rgba(239, 68, 68, 0.8)',
                                backgroundColor: 'rgba(239, 68, 68, 0.1)',
                                tension: 0.1,
                                borderWidth: 2,
                                pointRadius: 1,
                            },
                            {
                                label: `Test (${initialView}) - Senza Dropout`,
                                data: noDropoutData[curveKey],
                                borderColor: 'rgba(239, 68, 68, 1)',
                                backgroundColor: 'rgba(239, 68, 68, 0.2)',
                                tension: 0.1,
                                borderWidth: 2,
                                pointRadius: 2,
                                borderDash: [5, 5],
                            },
                             {
                                label: `Training (${initialView}) - Con Dropout`,
                                data: trainCurveWithDropout,
                                borderColor: 'rgba(5, 150, 105, 0.8)',
                                backgroundColor: 'rgba(5, 150, 105, 0.1)',
                                tension: 0.1,
                                borderWidth: 2,
                                pointRadius: 1,
                                hidden: true,
                            },
                            {
                                label: `Test (${initialView}) - Con Dropout`,
                                data: withDropoutData[curveKey],
                                borderColor: 'rgba(5, 150, 105, 1)',
                                backgroundColor: 'rgba(5, 150, 105, 0.2)',
                                tension: 0.1,
                                borderWidth: 2,
                                pointRadius: 2,
                                borderDash: [5, 5],
                                hidden: true,
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: type === 'loss',
                                title: { display: true, text: type.charAt(0).toUpperCase() + type.slice(1) }
                            },
                            x: {
                                title: { display: true, text: 'Epoche' }
                            }
                        },
                        plugins: {
                            tooltip: {
                                mode: 'index',
                                intersect: false,
                            },
                            legend: {
                                position: 'bottom',
                            }
                        },
                        interaction: {
                            mode: 'nearest',
                            axis: 'x',
                            intersect: false
                        }
                    }
                };
                return new Chart(ctx, chartConfig);
            };

            const updateChartData = (chart, data, type) => {
                const curveKey = `curve_${type === 'loss' ? 'loss' : 'acc'}`;
                const trainCurveNoDropout = generateSimulatedTrainingCurve(data.no_dropout[curveKey]);
                const trainCurveWithDropout = generateSimulatedTrainingCurve(data.with_dropout[curveKey]);
                
                chart.options.scales.y.beginAtZero = type === 'loss';
                chart.options.scales.y.title.text = type.charAt(0).toUpperCase() + type.slice(1);

                chart.data.datasets[0].data = trainCurveNoDropout;
                chart.data.datasets[1].data = data.no_dropout[curveKey];
                chart.data.datasets[2].data = trainCurveWithDropout;
                chart.data.datasets[3].data = data.with_dropout[curveKey];
                
                chart.data.datasets.forEach(ds => {
                    ds.label = ds.label.replace(/\((loss|accuratezza)\)/g, `(${type})`);
                });
                
                chart.update();
            };
            
            const updateUI = () => {
                const data = database[currentDataset];

                document.getElementById('analysis-text').textContent = data.analysis;
                document.getElementById('summary-best-accuracy').textContent = data.summary.best_accuracy;
                document.getElementById('summary-best-model').textContent = data.summary.best_model;
                document.getElementById('summary-improvement').textContent = data.summary.improvement;

                document.getElementById('btn-mnist').classList.toggle('active-dataset-btn', currentDataset === 'mnist');
                document.getElementById('btn-mnist').classList.toggle('inactive-dataset-btn', currentDataset !== 'mnist');
                document.getElementById('btn-fashion').classList.toggle('active-dataset-btn', currentDataset === 'fashion_mnist');
                document.getElementById('btn-fashion').classList.toggle('inactive-dataset-btn', currentDataset !== 'fashion_mnist');
                
                const singleLayerData = data.single_layer;
                document.getElementById('acc-single-no-dropout').textContent = singleLayerData.no_dropout.accuracy;
                document.getElementById('loss-single-no-dropout').textContent = singleLayerData.no_dropout.loss;
                document.getElementById('acc-single-with-dropout').textContent = singleLayerData.with_dropout.accuracy;
                document.getElementById('loss-single-with-dropout').textContent = singleLayerData.with_dropout.loss;
                
                const multiLayerData = data.multi_layer;
                document.getElementById('acc-multi-no-dropout').textContent = multiLayerData.no_dropout.accuracy;
                document.getElementById('loss-multi-no-dropout').textContent = multiLayerData.no_dropout.loss;
                document.getElementById('acc-multi-with-dropout').textContent = multiLayerData.with_dropout.accuracy;
                document.getElementById('loss-multi-with-dropout').textContent = multiLayerData.with_dropout.loss;

                if (chartSingle) chartSingle.destroy();
                chartSingle = createChart(document.getElementById('chart-single').getContext('2d'), singleLayerData, 'loss');

                if (chartMulti) chartMulti.destroy();
                chartMulti = createChart(document.getElementById('chart-multi').getContext('2d'), multiLayerData, 'loss');
                
                setupToggleListeners();
            };
            
            const setupToggleListeners = () => {
                document.getElementById('toggle-loss-single').onclick = () => updateChartData(chartSingle, database[currentDataset].single_layer, 'loss');
                document.getElementById('toggle-acc-single').onclick = () => updateChartData(chartSingle, database[currentDataset].single_layer, 'accuratezza');
                document.getElementById('toggle-loss-multi').onclick = () => updateChartData(chartMulti, database[currentDataset].multi_layer, 'loss');
                document.getElementById('toggle-acc-multi').onclick = () => updateChartData(chartMulti, database[currentDataset].multi_layer, 'accuratezza');
            };

            document.getElementById('btn-mnist').addEventListener('click', () => {
                currentDataset = 'mnist';
                updateUI();
            });

            document.getElementById('btn-fashion').addEventListener('click', () => {
                currentDataset = 'fashion_mnist';
                updateUI();
            });

            // Variabili per la demo interattiva
            let demoInterval;
            let currentEpoch = 0;
            let demoChart;
            let demoSpeed = 1500; // milliseconds per epoch
            let isPaused = false;
            let isRunning = false;

            // Crea la visualizzazione delle reti neurali con neuroni tipizzati
            const createNeuralNetwork = (containerId, layers, isDropout = false) => {
                const container = document.getElementById(containerId);
                if (!container) {
                    console.warn(`Container ${containerId} not found`);
                    return;
                }
                
                // Add loading state
                container.classList.add('loading');
                
                // Clean up any existing content and remove unwanted classes
                container.innerHTML = '';
                container.classList.remove('connections-fallback');
                
                // Ensure no unwanted styles are applied
                container.style.position = 'relative';
                container.style.overflow = 'hidden';
                
                // Remove any stray pseudo-elements or artifacts
                const computedStyle = window.getComputedStyle(container);
                if (computedStyle.position === 'static') {
                    container.style.position = 'relative';
                }
                
                layers.forEach((layerSize, layerIndex) => {
                    const layer = document.createElement('div');
                    layer.className = 'layer';
                    layer.setAttribute('data-layer-index', layerIndex);
                    
                    // Determina il tipo di layer
                    let layerType = 'hidden-layer';
                    if (layerIndex === 0) layerType = 'input-layer';
                    else if (layerIndex === layers.length - 1) layerType = 'output-layer';
                    
                    for (let i = 0; i < layerSize; i++) {
                        const neuron = document.createElement('div');
                        neuron.className = `neuron ${layerType}`;
                        neuron.id = `${containerId}-layer${layerIndex}-neuron${i}`;
                        neuron.setAttribute('data-neuron-index', i);
                        
                        // Aggiungi un tooltip per i neuroni
                        neuron.title = `Layer ${layerIndex + 1}, Neuron ${i + 1}`;
                        
                        layer.appendChild(neuron);
                    }
                    
                    container.appendChild(layer);
                });
                
                // Wait for DOM layout and then add connections
                requestAnimationFrame(() => {
                    requestAnimationFrame(() => {
                        addNeuralConnections(containerId, layers);
                        // Remove loading state
                        setTimeout(() => {
                            container.classList.remove('loading');
                        }, 200);
                    });
                });
            };

            // Aggiungi connessioni visive tra neuroni
            const addNeuralConnections = (containerId, layers) => {
                const container = document.getElementById(containerId);
                if (!container) return;
                
                const layerElements = container.querySelectorAll('.layer');
                
                // Complete cleanup of any existing visual artifacts
                const existingSVGs = container.querySelectorAll('svg.neural-connections');
                existingSVGs.forEach(svg => svg.remove());
                
                // Remove any stray connection elements
                const strayConnections = container.querySelectorAll('.connection, line, path');
                strayConnections.forEach(el => {
                    if (el.parentElement === container) {
                        el.remove();
                    }
                });
                
                // Ensure container is properly positioned
                if (window.getComputedStyle(container).position === 'static') {
                    container.style.position = 'relative';
                }
                
                // Create single SVG overlay for all connections
                const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
                svg.classList.add('neural-connections');
                svg.style.position = 'absolute';
                svg.style.top = '0';
                svg.style.left = '0';
                svg.style.width = '100%';
                svg.style.height = '100%';
                svg.style.pointerEvents = 'none';
                svg.style.zIndex = '1';
                svg.style.overflow = 'visible';
                
                // Wait for layout to complete
                setTimeout(() => {
                    try {
                        for (let i = 0; i < layerElements.length - 1; i++) {
                            const currentLayer = layerElements[i];
                            const nextLayer = layerElements[i + 1];
                            const currentNeurons = currentLayer.querySelectorAll('.neuron');
                            const nextNeurons = nextLayer.querySelectorAll('.neuron');
                            
                            // Create selected connections to avoid visual overload
                            currentNeurons.forEach((currentNeuron, currentIndex) => {
                                nextNeurons.forEach((nextNeuron, nextIndex) => {
                                    // Show connections selectively based on layer size and indices
                                    const shouldShowConnection = (
                                        (currentIndex % Math.max(1, Math.floor(currentNeurons.length / 3)) === 0 && 
                                         nextIndex % Math.max(1, Math.floor(nextNeurons.length / 3)) === 0) ||
                                        (currentNeurons.length <= 4 && nextNeurons.length <= 4) ||
                                        (Math.abs(currentIndex - nextIndex) <= 1)
                                    );
                                    
                                    if (shouldShowConnection) {
                                        const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                                        
                                        // Use offset positions for more reliable positioning
                                        const containerStyle = window.getComputedStyle(container);
                                        const containerPaddingLeft = parseFloat(containerStyle.paddingLeft) || 0;
                                        const containerPaddingTop = parseFloat(containerStyle.paddingTop) || 0;
                                        
                                        const currentNeuronStyle = window.getComputedStyle(currentNeuron);
                                        const nextNeuronStyle = window.getComputedStyle(nextNeuron);
                                        
                                        const currentNeuronWidth = parseFloat(currentNeuronStyle.width);
                                        const currentNeuronHeight = parseFloat(currentNeuronStyle.height);
                                        const nextNeuronHeight = parseFloat(nextNeuronStyle.height);
                                        
                                        // Calculate positions relative to container, accounting for padding
                                        const x1 = (currentNeuron.offsetLeft - containerPaddingLeft) + currentNeuronWidth;
                                        const y1 = (currentNeuron.offsetTop - containerPaddingTop) + currentNeuronHeight / 2;
                                        const x2 = nextNeuron.offsetLeft - containerPaddingLeft;
                                        const y2 = (nextNeuron.offsetTop - containerPaddingTop) + nextNeuronHeight / 2;
                                        
                                        line.setAttribute('x1', x1);
                                        line.setAttribute('y1', y1);
                                        line.setAttribute('x2', x2);
                                        line.setAttribute('y2', y2);
                                        line.setAttribute('stroke', '#cbd5e1');
                                        line.setAttribute('stroke-width', '2');
                                        line.setAttribute('opacity', '0.6');
                                        line.className = 'connection';
                                        
                                        svg.appendChild(line);
                                    }
                                });
                            });
                        }
                        
                        // Add SVG to container after all lines are created
                        container.appendChild(svg);
                    } catch (error) {
                    console.warn('Error creating neural connections:', error);
                    // Fallback: create simple visual connections without precise positioning
                    container.classList.add('connections-fallback');
                    
                    // Debug information
                    if (window.DEBUG_NEURAL_NETWORKS) {
                        console.log('Neural network debug info:', {
                            containerId,
                            containerDimensions: {
                                width: container.offsetWidth,
                                height: container.offsetHeight
                            },
                            layerCount: layerElements.length,
                            error: error.message
                        });
                    }
                }
                }, 150); // Increased delay to ensure proper layout
            };
            
            // Debug function for neural networks (can be called from browser console)
            window.debugNeuralNetworks = () => {
                window.DEBUG_NEURAL_NETWORKS = true;
                console.log('Neural network debugging enabled');
                
                ['network-no-dropout', 'network-with-dropout'].forEach(id => {
                    const container = document.getElementById(id);
                    if (container) {
                        console.log(`Container ${id}:`, {
                            dimensions: {
                                width: container.offsetWidth,
                                height: container.offsetHeight
                            },
                            layers: container.querySelectorAll('.layer').length,
                            neurons: container.querySelectorAll('.neuron').length,
                            connections: container.querySelectorAll('svg.neural-connections line').length
                        });
                    }
                });
            };
            
            // Clean up any visual artifacts in neural networks
            window.cleanupNeuralNetworks = () => {
                ['network-no-dropout', 'network-with-dropout'].forEach(id => {
                    const container = document.getElementById(id);
                    if (container) {
                        // Remove any stray elements that might cause visual artifacts
                        const strayElements = container.querySelectorAll('.connection, line:not(.neural-connections line), path:not(.neural-connections path), svg:not(.neural-connections)');
                        strayElements.forEach(el => el.remove());
                        
                        // Ensure proper container styling
                        container.style.position = 'relative';
                        container.style.overflow = 'hidden';
                        
                        // Reset any conflicting classes
                        container.classList.remove('connections-fallback');
                        
                        console.log(`Cleaned up container ${id}`);
                    }
                });
            };

            // Simula l'attivazione della rete con/senza dropout - versione migliorata
            const simulateNetworkActivation = (containerId, isDropout = false) => {
                const container = document.getElementById(containerId);
                if (!container) {
                    console.warn(`Container ${containerId} not found`);
                    return;
                }
                
                const neurons = container.querySelectorAll('.neuron');
                const layers = container.querySelectorAll('.layer');
                const svgConnections = container.querySelectorAll('svg.neural-connections line');
                
                // Reset stato precedente
                neurons.forEach(neuron => {
                    neuron.classList.remove('active', 'dropout');
                });
                
                // Reset SVG connections if they exist
                if (svgConnections.length > 0) {
                    svgConnections.forEach(conn => {
                        conn.setAttribute('stroke', '#cbd5e1');
                        conn.setAttribute('stroke-width', '2');
                        conn.setAttribute('opacity', '0.6');
                        conn.classList.remove('active', 'dropout');
                    });
                }
                
                // Animazione sequenziale layer per layer
                layers.forEach((layer, layerIndex) => {
                    const layerNeurons = layer.querySelectorAll('.neuron');
                    
                    setTimeout(() => {
                        layerNeurons.forEach((neuron, neuronIndex) => {
                            if (isDropout && layerIndex > 0 && layerIndex < layers.length - 1 && Math.random() < 0.3) {
                                // 30% dropout nei layer nascosti
                                neuron.classList.add('dropout');
                            } else {
                                // Attivazione normale
                                neuron.classList.add('active');
                            }
                        });
                        
                        // Attiva le connessioni uscenti da questo layer (solo se esistono)
                        if (layerIndex < layers.length - 1 && svgConnections.length > 0) {
                            setTimeout(() => {
                                svgConnections.forEach((conn, connIndex) => {
                                    const randomChance = Math.random();
                                    if (randomChance < 0.8) { // 80% delle connessioni attive
                                        conn.setAttribute('stroke', '#475569');
                                        conn.setAttribute('stroke-width', '3');
                                        conn.setAttribute('opacity', '0.9');
                                        conn.classList.add('active');
                                    } else if (isDropout && randomChance < 0.9) {
                                        // Alcune connessioni inattive con dropout
                                        conn.setAttribute('stroke', '#e2e8f0');
                                        conn.setAttribute('stroke-width', '1');
                                        conn.setAttribute('opacity', '0.3');
                                        conn.classList.add('dropout');
                                    }
                                });
                            }, 100);
                        }
                    }, layerIndex * 300); // Ritardo più lungo per migliore visualizzazione
                });
            };

            // Inizializza il grafico della demo
            const initDemoChart = () => {
                const ctx = document.getElementById('demo-chart').getContext('2d');
                demoChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: [],
                        datasets: [
                            {
                                label: 'Training Acc - Senza Dropout',
                                data: [],
                                borderColor: 'rgba(239, 68, 68, 1)',
                                backgroundColor: 'rgba(239, 68, 68, 0.1)',
                                tension: 0.1,
                                borderWidth: 3,
                            },
                            {
                                label: 'Test Acc - Senza Dropout',
                                data: [],
                                borderColor: 'rgba(239, 68, 68, 0.7)',
                                backgroundColor: 'rgba(239, 68, 68, 0.05)',
                                tension: 0.1,
                                borderWidth: 2,
                                borderDash: [5, 5],
                            },
                            {
                                label: 'Training Acc - Con Dropout',
                                data: [],
                                borderColor: 'rgba(16, 185, 129, 1)',
                                backgroundColor: 'rgba(16, 185, 129, 0.1)',
                                tension: 0.1,
                                borderWidth: 3,
                            },
                            {
                                label: 'Test Acc - Con Dropout',
                                data: [],
                                borderColor: 'rgba(16, 185, 129, 0.7)',
                                backgroundColor: 'rgba(16, 185, 129, 0.05)',
                                tension: 0.1,
                                borderWidth: 2,
                                borderDash: [5, 5],
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 1,
                                title: { display: true, text: 'Accuratezza' }
                            },
                            x: {
                                title: { display: true, text: 'Epoch' }
                            }
                        },
                        plugins: {
                            legend: {
                                position: 'bottom',
                            }
                        }
                    }
                });
            };

            // Aggiorna il grafico della demo con miglioramenti visivi
            const updateDemoChart = (epoch) => {
                // Aggiorna indicatori globali
                document.getElementById('current-epoch').textContent = epoch;
                document.getElementById('global-progress').style.width = `${(epoch / 20) * 100}%`;
                
                // Simula curve di training realistiche
                const baseAcc = 0.7 + (epoch / 20) * 0.25; // Parte da 70%, arriva a 95%
                const noise = () => (Math.random() - 0.5) * 0.02;
                
                // Senza dropout: overfitting più pronunciato
                const trainAccNoDropout = Math.min(0.98, baseAcc + (epoch / 20) * 0.15 + noise());
                const testAccNoDropout = Math.min(0.92, baseAcc + (epoch / 20) * 0.08 + noise());
                
                // Con dropout: migliore generalizzazione
                const trainAccWithDropout = Math.min(0.95, baseAcc + (epoch / 20) * 0.12 + noise());
                const testAccWithDropout = Math.min(0.94, baseAcc + (epoch / 20) * 0.11 + noise());

                // Aggiorna indicatori di stato
                const overfittingGap = Math.abs(trainAccNoDropout - testAccNoDropout);
                const dropoutGap = Math.abs(trainAccWithDropout - testAccWithDropout);
                
                if (overfittingGap > 0.05) {
                    document.getElementById('training-indicator').style.background = '#ef4444';
                } else {
                    document.getElementById('training-indicator').style.background = '#10b981';
                }
                
                if (dropoutGap < 0.03) {
                    document.getElementById('generalization-indicator').style.background = '#10b981';
                } else {
                    document.getElementById('generalization-indicator').style.background = '#f59e0b';
                }

                // Aggiorna il grafico
                demoChart.data.labels.push(`Ep. ${epoch}`);
                demoChart.data.datasets[0].data.push(trainAccNoDropout);
                demoChart.data.datasets[1].data.push(testAccNoDropout);
                demoChart.data.datasets[2].data.push(trainAccWithDropout);
                demoChart.data.datasets[3].data.push(testAccWithDropout);
                
                // Mantieni solo gli ultimi 15 punti per leggibilità
                if (demoChart.data.labels.length > 15) {
                    demoChart.data.labels.shift();
                    demoChart.data.datasets.forEach(dataset => dataset.data.shift());
                }
                
                demoChart.update('none');

                // Aggiorna i display numerici
                document.getElementById('acc-no-dropout').textContent = `${(testAccNoDropout * 100).toFixed(1)}%`;
                document.getElementById('acc-with-dropout').textContent = `${(testAccWithDropout * 100).toFixed(1)}%`;
                document.getElementById('epoch-no-dropout').textContent = epoch;
                document.getElementById('epoch-with-dropout').textContent = epoch;

                // Calcola e mostra il gap di overfitting
                document.getElementById('gap-no-dropout').textContent = `${(overfittingGap * 100).toFixed(1)}%`;
                document.getElementById('gap-with-dropout').textContent = `${(dropoutGap * 100).toFixed(1)}%`;

                // Aggiorna gli indicatori di overfitting
                const overfittingThreshold = 0.05;
                if (overfittingGap > overfittingThreshold) {
                    document.getElementById('overfitting-indicator-no-dropout').style.background = '#ef4444';
                    document.getElementById('overfitting-text-no-dropout').textContent = 'Overfitting!';
                } else {
                    document.getElementById('overfitting-indicator-no-dropout').style.background = '#10b981';
                    document.getElementById('overfitting-text-no-dropout').textContent = 'Normal';
                }
                
                if (dropoutGap < overfittingThreshold) {
                    document.getElementById('overfitting-indicator-with-dropout').style.background = '#10b981';
                    document.getElementById('overfitting-text-with-dropout').textContent = 'Buona Gen.';
                } else {
                    document.getElementById('overfitting-indicator-with-dropout').style.background = '#f59e0b';
                    document.getElementById('overfitting-text-with-dropout').textContent = 'Normal';
                }

                // Aggiorna la spiegazione dinamica
                let explanation = '';
                let globalStatus = '';
                if (epoch < 5) {
                    explanation = "🚀 Inizio training: entrambi i modelli stanno imparando rapidamente dai dati di training.";
                    globalStatus = "Fase iniziale di apprendimento";
                } else if (epoch < 10) {
                    explanation = "📈 Training in corso: il modello senza dropout sta iniziando a memorizzare i dati (possibile overfitting).";
                    globalStatus = "Rilevamento primi segni di overfitting";
                } else if (epoch < 15) {
                    explanation = "⚖️ Divergenza evidente: il dropout previene l'overfitting mantenendo performance simili su train e test.";
                    globalStatus = "Dropout previene efficacemente l'overfitting";
                } else {
                    explanation = "✅ Fine training: il dropout ha permesso una migliore generalizzazione con gap train-test minore.";
                    globalStatus = "Migliore generalizzazione con dropout";
                }
                
                document.getElementById('demo-explanation').textContent = explanation;
                document.getElementById('global-status').textContent = globalStatus;

                // Simula l'attivazione delle reti con timing migliorato
                simulateNetworkActivation('network-no-dropout', false);
                simulateNetworkActivation('network-with-dropout', true);
            };
            // Event listeners per i controlli della demo - sistema unificato
            document.getElementById('start-demo-btn').addEventListener('click', () => {
                if (isRunning) return;
                
                isRunning = true;
                isPaused = false;
                currentEpoch = 0;
                
                // Gestione UI
                document.getElementById('start-demo-btn').classList.add('hidden');
                document.getElementById('pause-demo-btn').classList.remove('hidden');
                document.getElementById('reset-demo-btn').classList.remove('hidden');

                // Inizializza le reti neurali
                if (window.cleanupNeuralNetworks) {
                    window.cleanupNeuralNetworks();
                }
                createNeuralNetwork('network-no-dropout', [8, 12, 8, 6, 3]);
                createNeuralNetwork('network-with-dropout', [8, 12, 8, 6, 3]);
                
                // Inizializza il grafico se non esiste
                if (!demoChart) {
                    initDemoChart();
                } else {
                    // Reset del grafico
                    demoChart.data.labels = [];
                    demoChart.data.datasets.forEach(dataset => dataset.data = []);
                    demoChart.update();
                }

                // Reset dei display
                resetDisplays();

                // Prima simulazione
                updateDemoChart(0);

                // Avvia l'intervallo
                startTraining();
            });

            document.getElementById('pause-demo-btn').addEventListener('click', () => {
                if (!isRunning) return;
                
                if (isPaused) {
                    // Resume
                    isPaused = false;
                    document.getElementById('pause-demo-btn').innerHTML = '⏸️ Pausa';
                    document.getElementById('resume-demo-btn').classList.add('hidden');
                    startTraining();
                } else {
                    // Pause
                    isPaused = true;
                    clearInterval(demoInterval);
                    document.getElementById('pause-demo-btn').innerHTML = '▶️ Riprendi';
                }
            });

            document.getElementById('resume-demo-btn').addEventListener('click', () => {
                if (!isPaused) return;
                
                isPaused = false;
                document.getElementById('pause-demo-btn').innerHTML = '⏸️ Pausa';
                document.getElementById('resume-demo-btn').classList.add('hidden');
                startTraining();
            });

            document.getElementById('reset-demo-btn').addEventListener('click', () => {
                resetDemo();
            });

            document.getElementById('speed-slider').addEventListener('input', (e) => {
                const speed = parseInt(e.target.value);
                demoSpeed = 2500 - (speed * 400); // Da 2100ms (lento) a 500ms (veloce)
                
                // Se è in esecuzione, riavvia con la nuova velocità
                if (isRunning && !isPaused) {
                    clearInterval(demoInterval);
                    startTraining();
                }
            });

            // Funzioni helper per la gestione della demo
            const startTraining = () => {
                demoInterval = setInterval(() => {
                    currentEpoch++;
                    updateDemoChart(currentEpoch);

                    if (currentEpoch >= 20) {
                        completeDemo();
                    }
                }, demoSpeed);
            };

            const resetDemo = () => {
                clearInterval(demoInterval);
                isRunning = false;
                isPaused = false;
                currentEpoch = 0;
                
                // Reset UI
                document.getElementById('start-demo-btn').classList.remove('hidden');
                document.getElementById('pause-demo-btn').classList.add('hidden');
                document.getElementById('resume-demo-btn').classList.add('hidden');
                document.getElementById('reset-demo-btn').classList.add('hidden');
                document.getElementById('pause-demo-btn').innerHTML = '⏸️ Pausa';
                
                // Reset del grafico
                if (demoChart) {
                    demoChart.data.labels = [];
                    demoChart.data.datasets.forEach(dataset => dataset.data = []);
                    demoChart.update();
                }
                
                // Reset displays
                resetDisplays();
                
                document.getElementById('global-status').textContent = 'Ready to start simulation';
                document.getElementById('demo-explanation').textContent = 
                    "Premi 'Avvia Simulazione' per vedere come il dropout influenza l'apprendimento della rete neurale.";
            };

            const resetDisplays = () => {
                document.getElementById('current-epoch').textContent = '0';
                document.getElementById('global-progress').style.width = '0%';
                document.getElementById('epoch-no-dropout').textContent = '0';
                document.getElementById('epoch-with-dropout').textContent = '0';
                document.getElementById('acc-no-dropout').textContent = '0.0%';
                document.getElementById('acc-with-dropout').textContent = '0.0%';
                document.getElementById('gap-no-dropout').textContent = '0.0%';
                document.getElementById('gap-with-dropout').textContent = '0.0%';
                
                // Reset indicatori
                document.getElementById('training-indicator').style.background = '#9ca3af';
                document.getElementById('generalization-indicator').style.background = '#9ca3af';
                document.getElementById('overfitting-indicator-no-dropout').style.background = '#9ca3af';
                document.getElementById('overfitting-indicator-with-dropout').style.background = '#9ca3af';
                document.getElementById('overfitting-text-no-dropout').textContent = 'Normal';
                document.getElementById('overfitting-text-with-dropout').textContent = 'Normal';
            };

            const completeDemo = () => {
                clearInterval(demoInterval);
                isRunning = false;
                
                // UI finale
                document.getElementById('start-demo-btn').classList.remove('hidden');
                document.getElementById('pause-demo-btn').classList.add('hidden');
                document.getElementById('resume-demo-btn').classList.add('hidden');
                document.getElementById('pause-demo-btn').innerHTML = '⏸️ Pausa';
                
                // Messaggio finale
                document.getElementById('global-status').textContent = 'Simulation completed successfully';
                document.getElementById('demo-explanation').textContent = 
                    "🎯 Demo completata! Il dropout ha mostrato una migliore capacità di generalizzazione riducendo l'overfitting. Prova a cambiare la velocità e riavviare per una nuova simulazione!";
            };

            updateUI();
            
            // Handle window resize to recalculate neural network connections
            let resizeTimeout;
            window.addEventListener('resize', () => {
                clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(() => {
                    // Recalculate connections for both networks if they exist
                    const networkNoDropout = document.getElementById('network-no-dropout');
                    const networkWithDropout = document.getElementById('network-with-dropout');
                    
                    if (networkNoDropout && networkNoDropout.children.length > 0) {
                        addNeuralConnections('network-no-dropout', [8, 12, 8, 6, 3]);
                    }
                    if (networkWithDropout && networkWithDropout.children.length > 0) {
                        addNeuralConnections('network-with-dropout', [8, 12, 8, 6, 3]);
                    }
                }, 300);
            });
            
            // Initialize neural networks on page load
            setTimeout(() => {
                try {
                    // Clean up any potential visual artifacts before creating networks
                    if (window.cleanupNeuralNetworks) {
                        window.cleanupNeuralNetworks();
                    }
                    
                    createNeuralNetwork('network-no-dropout', [8, 12, 8, 6, 3]);
                    createNeuralNetwork('network-with-dropout', [8, 12, 8, 6, 3]);
                    
                    // Add initial explanatory text
                    document.getElementById('global-status').textContent = 'Ready to start simulation';
                    document.getElementById('demo-explanation').textContent = 
                        "🚀 Premi 'Avvia Simulazione' per vedere una dimostrazione interattiva di come il dropout influenza l'apprendimento della rete neurale in tempo reale.";
                    
                    // Show a quick preview animation
                    setTimeout(() => {
                        simulateNetworkActivation('network-no-dropout', false);
                        setTimeout(() => {
                            simulateNetworkActivation('network-with-dropout', true);
                        }, 200);
                    }, 1000);
                    
                } catch (error) {
                    console.error('Error initializing neural networks:', error);
                    document.getElementById('demo-explanation').textContent = 
                        "⚠️ Errore nell'inizializzazione delle reti neurali. Ricarica la pagina per riprovare.";
                }
            }, 500);
        });
    </script>

</body>
</html>